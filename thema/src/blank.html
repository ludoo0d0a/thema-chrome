<!DOCTYPE html>
<html>
    <head>
        <script type="application/javascript" src="lib/jquery-1.4.2.min.js"></script>
        <title></title>
        <script type="text/javascript">
            var rendered = false;
            function printSource(a){
                var out = $('#output');
                out.html('');
                $.each(a.urls, function(i, url){
                    out.append('<p><a href="' + url + '">' + url + '</a></p>');
                });
                rendered = true;
            }
            
            function req(message, cb, data){
                if (chrome.extension) {
                    var o = data || {};
                    o.message = message;
                    chrome.extension.sendRequest(o, cb);
                }
            }
            
            function refresh(){
				console.log("refresh");
                //get id from uid
                var id = window.location.hash.replace(/^#/, '');
                req('getdata', function(o){
                    printSource(o);
                }, {
                    id: id
                });
            }
            
            $(document).ready(function(){
                $('#refresh').bind('click', refresh);
            });
            window.setTimeout(function(){
                if (!rendered){
					refresh();
				}
            }, 500);
        </script>
    </head>
    <body>
        <button id="refresh">
            Refresh
        </button>
        <div id="output">
        </div>
    </body>
</html>
